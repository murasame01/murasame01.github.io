<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>shell语法</title>
      <link href="/2023/09/06/shell%E8%AF%AD%E6%B3%95/"/>
      <url>/2023/09/06/shell%E8%AF%AD%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<h1 id="概论"><a href="#概论" class="headerlink" title="概论"></a>概论</h1><p>shell是我们通过命令行与操作系统沟通的语言。<br>shell脚本可以直接在命令行中执行，也可以将一套逻辑组织成一个文件，方便复用。<br>Linux中常见的shell脚本有很多种，常见的有：</p><blockquote><ul><li>Bourne Shell(&#x2F;usr&#x2F;bin&#x2F;sh或&#x2F;bin&#x2F;sh)</li><li>Bourne Again Shell(&#x2F;bin&#x2F;bash)</li><li>C Shell(&#x2F;usr&#x2F;bin&#x2F;csh)</li><li>K Shell(&#x2F;usr&#x2F;bin&#x2F;ksh)</li><li>…</li></ul></blockquote><p>Linux系统中一般默认使用bash，所以接下来讲解bash中的语法。<br>文件开头需要写#! &#x2F;bin&#x2F;bash，指明bash为脚本解释器。</p><p><strong>脚本示例</strong><br>新建一个test.sh文件，内容如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#! /bin/bash</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Hello World!&quot;</span></span><br><span class="line">```txt</span><br><span class="line">&gt;yuki@VM-4-3-ubuntu:~$ <span class="built_in">chmod</span> +x test.sh <span class="comment"># 使脚本具有可执行权限</span></span><br><span class="line">yuki@VM-4-3-ubuntu:~$ ./test.sh  <span class="comment"># 当前路径下执行</span></span><br><span class="line">Hello World! </span><br><span class="line">yuki@VM-4-3-ubuntu:~$ /home/yuki/test.sh  <span class="comment"># 绝对路径下执行</span></span><br><span class="line">Hello World! </span><br><span class="line">yuki@VM-4-3-ubuntu:~$ ~/test.sh   <span class="comment"># 家目录路径下执行</span></span><br><span class="line">Hello World! </span><br><span class="line">yuki@VM-4-3-ubuntu:~$ </span><br></pre></td></tr></table></figure><p><strong>用解释器运行</strong><br>yuki@VM-4-3-ubuntu:~$ bash test.sh<br>Hello World!</p><hr><h1 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h1><p><strong>单行注释</strong><br>每行中<code>#</code>之后的内容均是注释。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;Hello World&#x27;</span> </span><br></pre></td></tr></table></figure><p><strong>多行注释</strong><br>格式：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">:&lt;&lt;<span class="string">EOF</span></span><br><span class="line"><span class="string">第一行注释</span></span><br><span class="line"><span class="string">第二行注释</span></span><br><span class="line"><span class="string">第三行注释</span></span><br><span class="line"><span class="string">EOF</span></span><br></pre></td></tr></table></figure><p>其中EOF可以换成其它任意字符串。例如：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">:&lt;&lt;<span class="string">abc</span></span><br><span class="line"><span class="string">第一行注释</span></span><br><span class="line"><span class="string">第二行注释</span></span><br><span class="line"><span class="string">第三行注释</span></span><br><span class="line"><span class="string">abc</span></span><br><span class="line"></span><br><span class="line">:&lt;&lt;!</span><br><span class="line">第一行注释</span><br><span class="line">第二行注释</span><br><span class="line">第三行注释</span><br><span class="line">!</span><br></pre></td></tr></table></figure><hr><h1 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h1><p><strong>定义变量</strong><br>定义变量，不需要加$符号，例如：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">name1=<span class="string">&#x27;yxc&#x27;</span>  <span class="comment"># 单引号定义字符串</span></span><br><span class="line">name2=<span class="string">&quot;yxc&quot;</span>  <span class="comment"># 双引号定义字符串</span></span><br><span class="line">name3=yxc    <span class="comment"># 也可以不加引号，同样表示字符串</span></span><br></pre></td></tr></table></figure><p><strong>使用变量</strong><br>使用变量，需要加上$符号，或者${}符号。花括号是可选的，主要为了帮助解释器识别变量边界。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">name=yuki</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$name</span>  <span class="comment"># 输出yuki</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;name&#125;</span>  <span class="comment"># 输出yuki</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;name&#125;</span><span class="built_in">tail</span><span class="comment"># 输出yukitail</span></span><br></pre></td></tr></table></figure><p><strong>只读变量</strong><br>使用readonly或者declare可以将变量变为只读。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">name=yxc</span><br><span class="line"><span class="built_in">readonly</span> name</span><br><span class="line"><span class="built_in">declare</span> -r name  <span class="comment"># 两种写法均可</span></span><br><span class="line">name=abc  <span class="comment"># 会报错，因为此时name只读</span></span><br></pre></td></tr></table></figure><p><strong>删除变量</strong><br>unset可以删除变量。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">name=yuki</span><br><span class="line"><span class="built_in">unset</span> name</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$name</span>  <span class="comment"># 输出空行</span></span><br></pre></td></tr></table></figure><p><strong>变量类型</strong></p><ol><li>自定义变量（局部变量）<br>子进程不能访问的变量</li><li>环境变量（全局变量）<br>子进程可以访问的变量</li></ol><p>自定义变量改成环境变量：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yuki@VM-4-3-ubuntu:~$ name=yuki</span><br><span class="line">yuki@VM-4-3-ubuntu:~$ <span class="built_in">export</span> name</span><br><span class="line">yuki@VM-4-3-ubuntu:~$ <span class="built_in">declare</span> -x name</span><br></pre></td></tr></table></figure><p>环境变量改为自定义变量：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">acs@9e0ebfcd82d7:~$ <span class="built_in">export</span> name=yxc  <span class="comment"># 定义环境变量</span></span><br><span class="line">acs@9e0ebfcd82d7:~$ <span class="built_in">declare</span> +x name  <span class="comment"># 改为自定义变量</span></span><br></pre></td></tr></table></figure><p><strong>字符串</strong><br>字符串可以用单引号，也可以用双引号，也可以不用引号。<br>单引号与双引号的区别：<br>单引号中的内容会原样输出，不会执行、不会取变量；<br>双引号中的内容可以执行、可以取变量；</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">yuki@VM-4-3-ubuntu:~$ name=yuki</span><br><span class="line">yuki@VM-4-3-ubuntu:~$ <span class="built_in">echo</span> <span class="string">&#x27;hello, $name \&quot;hh\&quot;&#x27;</span></span><br><span class="line">hello, <span class="variable">$name</span> \&quot;hh\&quot;</span><br><span class="line">yuki@VM-4-3-ubuntu:~$ <span class="built_in">echo</span> <span class="string">&quot;hello, <span class="variable">$name</span> \&quot;hh\&quot;&quot;</span></span><br><span class="line">hello, yuki <span class="string">&quot;hh&quot;</span></span><br></pre></td></tr></table></figure><p>获取字符串长度</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">uki@VM-4-3-ubuntu:~$ name=yuki</span><br><span class="line">yuki@VM-4-3-ubuntu:~$ <span class="built_in">echo</span> <span class="variable">$&#123;#name&#125;</span></span><br><span class="line">4</span><br><span class="line">yuki@VM-4-3-ubuntu:~$ str=abcdefg</span><br><span class="line">yuki@VM-4-3-ubuntu:~$ <span class="built_in">echo</span> <span class="variable">$&#123;str:0:3&#125;</span></span><br><span class="line">abc</span><br></pre></td></tr></table></figure><hr><h1 id="默认变量"><a href="#默认变量" class="headerlink" title="默认变量"></a>默认变量</h1><p><strong>文件参数变量</strong><br>在执行shell脚本时，可以向脚本传递参数。<code>$1</code>是第一个参数，<code>$2</code>是第二个参数，以此类推。特殊的，<code>$0</code>是文件名（包含路径）。例如：<br>创建文件test.sh：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#! /bin/bash</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;文件名：&quot;</span><span class="variable">$0</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;第一个参数：&quot;</span><span class="variable">$1</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;第二个参数：&quot;</span><span class="variable">$2</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;第三个参数：&quot;</span><span class="variable">$3</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;第四个参数：&quot;</span><span class="variable">$4</span></span><br></pre></td></tr></table></figure><p>然后执行该脚本：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">yuki@VM-4-3-ubuntu:~$ <span class="built_in">chmod</span> +x test.sh </span><br><span class="line">yuki@VM-4-3-ubuntu:~$ ./test.sh  1 2 3 4</span><br><span class="line">文件名：./test.sh</span><br><span class="line">第一个参数：1</span><br><span class="line">第二个参数：2</span><br><span class="line">第三个参数：3</span><br><span class="line">第四个参数：4</span><br></pre></td></tr></table></figure><p><strong>其它参数相关变量</strong></p><table><thead><tr><th align="center">参数</th><th>说明</th></tr></thead><tbody><tr><td align="center"><code>$#</code></td><td>代表文件传入的参数个数，如上例中值为4</td></tr><tr><td align="center"><code>$*</code></td><td>由所有参数构成的用空格隔开的字符串，如上例中值为”$1 $2 $3 $4”</td></tr><tr><td align="center"><code>$@</code></td><td>每个参数分别用双引号括起来的字符串，如上例中值为”$1” “$2” “$3” “$4”</td></tr><tr><td align="center"><code>$$</code></td><td>脚本当前运行的进程ID</td></tr><tr><td align="center"><code>$?</code></td><td>上一条命令的退出状态（注意不是stdout，而是exit code）。0表示正常退出，其他值表示错误</td></tr><tr><td align="center"><code>$(command)</code></td><td>返回command这条命令的stdout（可嵌套）</td></tr><tr><td align="center">&#96;&#96;command&#96;</td><td>返回command这条命令的stdout（不可嵌套）</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> shell </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ssh基本用法</title>
      <link href="/2023/09/06/ssh%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95/"/>
      <url>/2023/09/06/ssh%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<h1 id="ssh登录"><a href="#ssh登录" class="headerlink" title="ssh登录"></a>ssh登录</h1><h2 id="远程登录服务器"><a href="#远程登录服务器" class="headerlink" title="远程登录服务器"></a>远程登录服务器</h2><blockquote><p>ssh user@hostname</p></blockquote><ul><li>user: 用户名</li><li>hostname: IP地址或域名</li></ul><p>第一次登录会提示:</p><blockquote><p>The authenticity of host ‘123.57.47.211 (123.57.47.211)’ can’t be established.<br>ECDSA key fingerprint is SHA256:iy237yysfCe013&#x2F;l+kpDGfEG9xxHxm0dnxnAbJTPpG8.<br>Are you sure you want to continue connecting (yes&#x2F;no&#x2F;[fingerprint])?</p></blockquote><p>输入yes，然后回车即可。<br>这样会将该服务器的信息记录在~&#x2F;.ssh&#x2F;known_hosts文件中。<br>然后输入密码即可登录到远程服务器中。</p><p>*默认登录端口号为22,如果想登录某一特定端口:</p><blockquote><p>ssh user@hostname -p 22  </p></blockquote><hr><h2 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h2><p>创建文件 ~&#x2F;.ssh&#x2F;config</p><blockquote><p>Host myserver1<br>    HostName IP地址或域名<br>    User 用户名</p></blockquote><p>Host myserver2<br>    HostName IP地址或域名<br>    User 用户名<br>之后再使用服务器时,可以直接用myserver1</p><hr><h2 id="密钥登陆"><a href="#密钥登陆" class="headerlink" title="密钥登陆"></a>密钥登陆</h2><p>创建密钥:</p><blockquote><p>ssh-keygen<br>然后一直按回车即可<br>执行结束后, ~&#x2F;.ssh&#x2F;目录下会多两个文件</p></blockquote><ul><li>id_rsa: 私钥</li><li>id_rsa.pub: 公钥</li></ul><p>之后想免密码登录哪个服务器，就将公钥传给哪个服务器即可。</p><p>例如，想免密登录myserver服务器。则将公钥中的内容，复制到myserver中的~&#x2F;.ssh&#x2F;authorized_keys文件里即可。</p><p>也可以使用如下命令一键添加公钥:</p><blockquote><p>ssh-copy-id myserver</p></blockquote><h2 id="执行命令"><a href="#执行命令" class="headerlink" title="执行命令"></a>执行命令</h2><p>命令格式:</p><blockquote><p>ssh user@hostname command</p></blockquote><hr><h1 id="scp传文件"><a href="#scp传文件" class="headerlink" title="scp传文件"></a>scp传文件</h1><h2 id="基本用法"><a href="#基本用法" class="headerlink" title="基本用法"></a>基本用法</h2><h2 id="命令格式-scp-source-destination将source目录下的文件复制到-destination中"><a href="#命令格式-scp-source-destination将source目录下的文件复制到-destination中" class="headerlink" title="命令格式:&gt;scp source destination将source目录下的文件复制到 destination中  "></a>命令格式:<br>&gt;scp source destination<br>将<code>source</code>目录下的文件复制到 <code>destination</code>中  </h2><h2 id="一次性复制多个目录-scp-source1-source2-destination"><a href="#一次性复制多个目录-scp-source1-source2-destination" class="headerlink" title="一次性复制多个目录:&gt;scp source1 source2 destination"></a>一次性复制多个目录:<br>&gt;scp source1 source2 destination</h2><p>复制文件夹:</p><blockquote><p>scp -r ~&#x2F;tmp myserver:&#x2F;home&#x2F;acs&#x2F;</p></blockquote><p>将本地目录中的<code>tmp</code>文件夹复制到<code>myserver</code>服务器中的<code>/home/acs/</code>目录下</p><blockquote><p>scp -r myserver:homework <strong>.</strong></p></blockquote><p>将<code>myserver</code>服务器中的<code>~/homework/</code>文件夹复制到本地的当前路径下</p><p>指定服务器端口号:</p><blockquote><p>scp -P 22 source1 source2 destination</p></blockquote><p><strong>注意</strong>： scp的-r -P等参数尽量加在source和destination之前。</p><p>使用<code>scp</code>配置其他服务器的<code>vim</code>和<code>tmux</code></p><blockquote><p>scp ~&#x2F;.vimrc ~&#x2F;.tmux.conf myserver:</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ssh </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>first-post</title>
      <link href="/2023/09/06/first-post/"/>
      <url>/2023/09/06/first-post/</url>
      
        <content type="html"><![CDATA[<h1 id="My-first-post"><a href="#My-first-post" class="headerlink" title="My first post"></a>My first post</h1><hr><p><img src="https://s2.loli.net/2023/08/31/hNB9guxCIfXSYal.jpg"></p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
